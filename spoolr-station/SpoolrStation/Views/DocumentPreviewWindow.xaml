<Window x:Class="SpoolrStation.Views.DocumentPreviewWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        Title="Document Preview" 
        Height="800" 
        Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">
    
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="350"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <!-- Left Panel -->
        <Border Grid.Column="0" Background="White" BorderBrush="#E0E0E0" BorderThickness="0,0,1,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="15">
                <StackPanel>
                    
                    <!-- Job Details -->
                    <Border BorderBrush="#2196F3" BorderThickness="2" Background="#F3F9FF" 
                            CornerRadius="8" Padding="15" Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="ðŸ“‹ Job Details" FontSize="16" FontWeight="Bold" 
                                     Foreground="#1976D2" Margin="0,0,0,10"/>
                            
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Customer:" FontWeight="SemiBold" Margin="0,3"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Job.CustomerDisplayName}" 
                                         Margin="8,3,0,3" TextWrapping="Wrap"/>
                                
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="File:" FontWeight="SemiBold" Margin="0,3"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Job.FileDisplayInfo}" 
                                         Margin="8,3,0,3" TextWrapping="Wrap"/>
                                
                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Tracking:" FontWeight="SemiBold" Margin="0,3"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Job.TrackingCode}" 
                                         Margin="8,3,0,3" FontFamily="Consolas"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                    
                    <!-- Printer Selection -->
                    <Border BorderBrush="#4CAF50" BorderThickness="2" Background="#E8F5E8" 
                            CornerRadius="8" Padding="15" Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="ðŸ–¨ï¸ Printer Selection" FontSize="16" FontWeight="Bold" 
                                     Foreground="#2E7D32" Margin="0,0,0,10"/>
                            
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Text="Select Printer:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                <ComboBox Grid.Row="1" x:Name="PrinterComboBox"
                                        ItemsSource="{Binding AvailablePrinters}"
                                        SelectedItem="{Binding SelectedPrinter}"
                                        Height="30"
                                        Margin="0,0,0,5">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding StatusIcon}" Margin="0,0,5,0"/>
                                                <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold"/>
                                                <TextBlock Text=" - " Margin="3,0"/>
                                                <TextBlock Text="{Binding CompatibilityMessage}" 
                                                          Foreground="{Binding CompatibilityColor}" FontSize="11"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                
                            </Grid>
                        </StackPanel>
                    </Border>
                    
                    <!-- Print Specifications -->
                    <Border BorderBrush="#FF9800" BorderThickness="2" Background="#FFF8E1" 
                            CornerRadius="8" Padding="15" Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="ðŸ”’ Print Specifications (Locked)" FontSize="16" FontWeight="Bold" 
                                     Foreground="#F57C00" Margin="0,0,0,10"/>
                            
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Paper:" FontWeight="SemiBold" Margin="0,3"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Job.PrintSpecs.PaperSizeDisplay}" 
                                         Margin="8,3,0,3"/>
                                <TextBlock Grid.Row="0" Grid.Column="2" Text="ðŸ”’" Foreground="#FF9800" FontSize="14"/>
                                
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Color:" FontWeight="SemiBold" Margin="0,3"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Job.PrintSpecs.ColorModeDisplay}" 
                                         Margin="8,3,0,3"/>
                                <TextBlock Grid.Row="1" Grid.Column="2" Text="ðŸ”’" Foreground="#FF9800" FontSize="14"/>
                                
                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Sides:" FontWeight="SemiBold" Margin="0,3"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Job.PrintSpecs.SidesDisplay}" 
                                         Margin="8,3,0,3"/>
                                <TextBlock Grid.Row="2" Grid.Column="2" Text="ðŸ”’" Foreground="#FF9800" FontSize="14"/>
                                
                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Copies:" FontWeight="SemiBold" Margin="0,3"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding Job.PrintSpecs.CopiesDisplay}" 
                                         Margin="8,3,0,3"/>
                                <TextBlock Grid.Row="3" Grid.Column="2" Text="ðŸ”’" Foreground="#FF9800" FontSize="14"/>
                                
                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Cost:" FontWeight="SemiBold" Margin="0,3"/>
                                <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding Job.PrintSpecs.TotalCostDisplay}" 
                                         Margin="8,3,0,3" FontWeight="Bold" Foreground="#4CAF50" FontSize="14"/>
                                <TextBlock Grid.Row="4" Grid.Column="2" Text="ðŸ”’" Foreground="#FF9800" FontSize="14"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                    
                    <!-- Action Buttons -->
                    <Button x:Name="PrintButton"
                            Content="ðŸ–¨ï¸ Print Document"
                            Click="PrintButton_Click"
                            Background="#2196F3" 
                            Foreground="White"
                            FontSize="14" 
                            FontWeight="Bold"
                            Height="45"
                            Margin="0,10,0,10"
                            IsEnabled="{Binding CanPrint}"/>
                    
                    <Button x:Name="RejectButton"
                            Content="âŒ Reject Job"
                            Click="RejectButton_Click"
                            Background="#F44336" 
                            Foreground="White"
                            FontSize="12"
                            Height="35"
                            Margin="0,5,0,5"/>
                    
                    <Button x:Name="RefreshButton"
                            Content="ðŸ”„ Refresh Preview"
                            Click="RefreshButton_Click"
                            Background="#666" 
                            Foreground="White"
                            FontSize="12"
                            Height="35"
                            Margin="0,5,0,5"/>
                    
                </StackPanel>
            </ScrollViewer>
        </Border>
        
        <!-- Right Panel: Document Preview -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!-- PDF Navigation Toolbar -->
            <Border Grid.Row="0" Background="#FAFAFA" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" 
                    Visibility="{Binding IsPdfDocument, Converter={StaticResource BooleanToVisibilityConverter}}">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="10">
                    
                    <!-- Page Navigation -->
                    <Button x:Name="PreviousPageButton"
                            Content="â¬… Previous"
                            Click="PreviousPageButton_Click"
                            Background="#2196F3" 
                            Foreground="White"
                            Padding="10,5"
                            Margin="5,0"/>
                    
                    <TextBlock Text="{Binding CurrentPage}" 
                               FontWeight="Bold"
                               VerticalAlignment="Center"
                               Margin="10,0,5,0"/>
                    <TextBlock Text="of" 
                               VerticalAlignment="Center"
                               Margin="0,0,5,0"/>
                    <TextBlock Text="{Binding TotalPages}" 
                               FontWeight="Bold"
                               VerticalAlignment="Center"
                               Margin="0,0,10,0"/>
                    
                    <Button x:Name="NextPageButton"
                            Content="Next âž¡"
                            Click="NextPageButton_Click"
                            Background="#2196F3" 
                            Foreground="White"
                            Padding="10,5"
                            Margin="5,0"/>
                    
                    <!-- Separator -->
                    <Separator Margin="15,0" Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}"/>
                    
                    <!-- Zoom Controls -->
                    <Button x:Name="ZoomOutButton"
                            Content="ðŸ”-"
                            Click="ZoomOutButton_Click"
                            Background="#FF9800" 
                            Foreground="White"
                            Padding="8,5"
                            Margin="5,0"/>
                    
                    <TextBlock Text="{Binding ZoomLevelText}" 
                               FontWeight="Bold"
                               VerticalAlignment="Center"
                               Margin="10,0"
                               MinWidth="50"
                               TextAlignment="Center"/>
                    
                    <Button x:Name="ZoomInButton"
                            Content="ðŸ”+"
                            Click="ZoomInButton_Click"
                            Background="#FF9800" 
                            Foreground="White"
                            Padding="8,5"
                            Margin="5,0"/>
                    
                    <Button x:Name="FitToWidthButton"
                            Content="ðŸ“ Fit"
                            Click="FitToWidthButton_Click"
                            Background="#4CAF50" 
                            Foreground="White"
                            Padding="10,5"
                            Margin="10,0,5,0"/>
                    
                </StackPanel>
            </Border>
            
            <!-- Document WebView -->
            <wv2:WebView2 x:Name="DocumentWebView" Grid.Row="1"/>
        </Grid>
        
    </Grid>
</Window>