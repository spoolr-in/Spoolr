<Window x:Class="SpoolrStation.Views.LoginWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Spoolr Station - Login" 
        Height="600" 
        Width="450"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        MinHeight="550"
        MinWidth="400"
        Background="#f8f9fa"
        Loaded="Window_Loaded"
        KeyDown="Window_KeyDown"
        Closing="Window_Closing">
    
    <Window.Resources>
        <!-- Converters -->
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        
        <!-- Styles -->
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#2c3e50"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        
        <Style x:Key="SubHeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#7f8c8d"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
        </Style>
        
        <Style x:Key="InputLabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Foreground" Value="#34495e"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
        </Style>
        
        <Style x:Key="InputTextBoxStyle" TargetType="TextBox">
            <Setter Property="Height" Value="35"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderBrush" Value="#bdc3c7"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#3498db"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="InputPasswordBoxStyle" TargetType="PasswordBox">
            <Setter Property="Height" Value="35"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderBrush" Value="#bdc3c7"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#3498db"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Height" Value="40"/>
            <Setter Property="Background" Value="#3498db"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="0,10,0,0"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2980b9"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#bdc3c7"/>
                    <Setter Property="Cursor" Value="Arrow"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Height" Value="35"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#3498db"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Margin" Value="0,10,0,0"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Foreground" Value="#2980b9"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="ErrorTextStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#e74c3c"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
    </Window.Resources>
    
    <Grid>
        <!-- Main Content with ScrollViewer -->
        <ScrollViewer VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled">
            <StackPanel Margin="40" VerticalAlignment="Top">
            
            <!-- Logo/Header -->
            <StackPanel Margin="0,0,0,30">
                <TextBlock Text="ðŸ–¨ï¸" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                <TextBlock Text="Spoolr Station" Style="{StaticResource HeaderTextStyle}"/>
            </StackPanel>
            
            <!-- First-Time Setup UI -->
            <StackPanel Name="FirstTimeSetupPanel" Visibility="{Binding IsFirstTimeSetup, Converter={StaticResource BoolToVis}}">
                <TextBlock Text="Welcome to Spoolr!" Style="{StaticResource HeaderTextStyle}"/>
                <TextBlock Style="{StaticResource SubHeaderTextStyle}">
                    Enter your activation key from the email and set a password for your Station app.
                </TextBlock>
                
                <TextBlock Text="Activation Key" Style="{StaticResource InputLabelStyle}"/>
                <TextBox Name="ActivationKeyTextBox" 
                         Text="{Binding ActivationKey, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{StaticResource InputTextBoxStyle}"/>
                
                <TextBlock Text="New Password" Style="{StaticResource InputLabelStyle}"/>
                <PasswordBox Name="NewPasswordBox" 
                             Style="{StaticResource InputPasswordBoxStyle}"/>
                
                <TextBlock Text="Confirm Password" Style="{StaticResource InputLabelStyle}"/>
                <PasswordBox Name="ConfirmPasswordBox" 
                             Style="{StaticResource InputPasswordBoxStyle}"/>
                
                <!-- Error Message for First-Time Setup -->
                <TextBlock Text="{Binding ErrorMessage}" 
                           Style="{StaticResource ErrorTextStyle}"
                           Visibility="{Binding HasError, Converter={StaticResource BoolToVis}}"/>
                
                <Button Content="Activate Station" 
                        Style="{StaticResource PrimaryButtonStyle}"
                        Command="{Binding FirstTimeLoginCommand}"/>
                        
                <Button Content="Already have an account? Sign In" 
                        Style="{StaticResource SecondaryButtonStyle}"
                        Command="{Binding SwitchToRegularLoginCommand}"/>
            </StackPanel>
            
            <!-- Regular Login UI -->
            <StackPanel Name="RegularLoginPanel">
                <TextBlock Text="Welcome Back!" Style="{StaticResource HeaderTextStyle}"/>
                <TextBlock Text="Sign in to your Station app" Style="{StaticResource SubHeaderTextStyle}"/>
                
                <TextBlock Text="Store Code" Style="{StaticResource InputLabelStyle}"/>
                <TextBox Text="{Binding StoreCode, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{StaticResource InputTextBoxStyle}"/>
                
                <TextBlock Text="Password" Style="{StaticResource InputLabelStyle}"/>
                <PasswordBox Name="PasswordBox" 
                             Style="{StaticResource InputPasswordBoxStyle}"/>
                
                <!-- Error Message for Regular Login -->
                <TextBlock Text="{Binding ErrorMessage}" 
                           Style="{StaticResource ErrorTextStyle}"
                           Visibility="{Binding HasError, Converter={StaticResource BoolToVis}}"/>
                
                <Button Content="Sign In" 
                        Style="{StaticResource PrimaryButtonStyle}"
                        Command="{Binding RegularLoginCommand}"/>
                        
                <Button Content="First Time Setup" 
                        Style="{StaticResource SecondaryButtonStyle}"
                        Command="{Binding SwitchToFirstTimeSetupCommand}"/>
            </StackPanel>
                       
            </StackPanel>
        </ScrollViewer>
        
        <!-- Loading Overlay -->
        <Grid Background="#80000000" Visibility="{Binding IsLoading, Converter={StaticResource BoolToVis}}">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="100" Height="6" Margin="0,0,0,15"/>
                <TextBlock Text="Signing in..." FontSize="14" Foreground="White" HorizontalAlignment="Center"/>
            </StackPanel>
        </Grid>
        
    </Grid>
</Window>
